<div class="mb-4">
  <%= link_to "â† Back to Dashboard", root_path,
    class: "inline-block bg-gray-200 text-gray-800 hover:bg-gray-300 px-4 py-2 rounded text-sm" %>
</div>

<h1 class="text-2xl font-bold text-blue-700 mb-6">Product List</h1>

<div class="mb-4">
  <%= link_to "Add New Product", new_product_path, class: "bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded" %>
</div>

<table class="min-w-full bg-white shadow rounded-lg overflow-hidden">
  <thead class="bg-gray-100">
    <tr>
      <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Name</th>
      <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">SKU</th>
      <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Quantity</th>
      <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Initial Stock</th>
      <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Expire Date</th>
      <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Status</th>
      <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Actions</th>
    </tr>
  </thead>
  <tbody>
    <% @products.each do |product| %>
      <% percent_left = (product.quantity.to_f / product.initial_stock.to_f * 100).round rescue 100 %>
      <tr class="border-t">
        <td class="px-4 py-2 text-sm"><%= product.name %></td>
        <td class="px-4 py-2 text-sm"><%= product.sku %></td>
        <td class="px-4 py-2 text-sm"><%= product.quantity %></td>
        <td class="px-4 py-2 text-sm"><%= product.initial_stock %></td>
        <td class="px-4 py-2 text-sm"><%= product.expire_date %></td>
        <td class="px-4 py-2 text-sm">
          <% if percent_left <= 20 %>
            <span class="bg-red-500 text-white px-2 py-1 rounded text-xs font-semibold">Low Stock</span>
          <% elsif percent_left <= 50 %>
            <span class="bg-yellow-500 text-black px-2 py-1 rounded text-xs font-semibold">Low Stock</span>
          <% else %>
            <span class="bg-green-500 text-white px-2 py-1 rounded text-xs font-semibold">In Stock</span>
          <% end %>
        </td>
        <td class="px-4 py-2 space-x-2">
          <%= link_to "View", product_path(product), class: "text-blue-600 hover:underline text-sm" %>
          <%= link_to "Edit", edit_product_path(product), class: "text-yellow-600 hover:underline text-sm" %>
          <%= link_to "Delete", product_path(product), method: :delete, data: { confirm: "Are you sure?" }, class: "text-red-600 hover:underline text-sm" %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
